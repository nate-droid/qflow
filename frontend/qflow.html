<!DOCTYPE html>
<html lang="en" class="h-full bg-slate-900">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Workflow UI</title>

    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.28.1/cytoscape.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dagre/0.8.5/dagre.min.js"></script>
    <script src="https://unpkg.com/cytoscape-dagre@2.5.0/cytoscape-dagre.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

    <!-- Custom Styles -->
    <style>
        :root {
            --brand-color: #4f46e5; /* indigo-600 */
            --brand-color-hover: #4338ca; /* indigo-700 */
            --bg-primary: #0f172a; /* slate-900 */
            --bg-secondary: #1e293b; /* slate-800 */
            --bg-tertiary: #334155; /* slate-700 */
            --border-primary: #334155;
            --border-secondary: #475569; /* slate-600 */
            --text-primary: #e2e8f0; /* slate-200 */
            --text-secondary: #94a3b8; /* slate-400 */
            --text-accent: #818cf8; /* indigo-400 */
        }
        body {
            font-family: 'Inter', sans-serif;
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .font-code { font-family: 'Fira Code', monospace; }

        #cy { height: 100%; width: 100%; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-secondary); }
        ::-webkit-scrollbar-thumb { background: var(--border-secondary); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; } /* slate-500 */

        /* Modal Styles */
        .modal-overlay {
            position: fixed; inset: 0; background-color: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(4px);
            display: none; align-items: center; justify-content: center; z-index: 100;
            opacity: 0; transition: opacity 0.2s ease-in-out;
        }
        .modal-overlay.visible { display: flex; opacity: 1; }
        .modal-content {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            padding: 1.5rem; border-radius: 0.5rem;
            width: 90%; max-width: 800px; max-height: 90vh;
            display: flex; flex-direction: column;
            transform: scale(0.95); opacity: 0;
            transition: transform 0.2s ease-in-out, opacity 0.2s ease-in-out;
        }
        .modal-overlay.visible .modal-content { transform: scale(1); opacity: 1; }
        .modal-content h2 { font-size: 1.25rem; font-weight: 600; margin-bottom: 1.5rem; }
        .modal-close-btn {
            position: absolute; top: 0.75rem; right: 0.75rem; color: var(--text-secondary);
            cursor: pointer; background: none; border: none; font-size: 1.5rem; line-height: 1;
        }
        .modal-close-btn:hover { color: var(--text-primary); }

        /* Button Styles */
        .btn { transition: background-color 0.2s; }
        .btn-primary { background-color: var(--brand-color); color: white; font-weight: 500; padding: 0.625rem 1rem; border-radius: 0.375rem; text-align: center; cursor: pointer; }
        .btn-primary:hover:not(:disabled) { background-color: var(--brand-color-hover); }
        .btn-primary:disabled { background-color: #374151; cursor: not-allowed; }
        .btn-success { background-color: #16a34a; color: white; font-weight: 500; padding: 0.5rem 1rem; border-radius: 0.375rem; text-align: center; cursor: pointer; }
        .btn-success:hover { background-color: #15803d; }

        /* D3 Chart Styles */
        #q-state-vis-container { background-color: #020617; border-radius: 0.5rem; padding: 1.5rem 1rem 1rem 0; } /* slate-950 */
        .vis-bar { fill: var(--text-accent); transition: fill 0.2s; }
        .vis-bar:hover { fill: #a5b4fc; } /* indigo-300 */
        .vis-axis path, .vis-axis line { stroke: var(--border-secondary); }
        .vis-axis text { fill: var(--text-secondary); font-family: 'Fira Code', monospace; font-size: 0.75rem; }
        .vis-grid line { stroke: var(--border-primary); stroke-opacity: 0.7; shape-rendering: crispEdges; }
        .vis-grid path { stroke-width: 0; }

        /* Navigation */
        .nav-link {
            border-bottom: 2px solid transparent;
            transition: color 0.2s, border-color 0.2s;
            cursor: pointer;
        }
        .nav-link.active {
            color: var(--brand-color);
            border-bottom-color: var(--brand-color);
        }

    </style>
    <script src="qflow.js"></script>
</head>
<body class="h-full">
<div class="flex flex-col h-screen bg-slate-900">
    <!-- Header -->
    <header class="bg-slate-900/70 backdrop-blur-sm border-b border-slate-700/80 p-4 shadow-lg z-20 flex justify-between items-center shrink-0">
        <div class="flex items-center gap-8">
            <h1 class="text-xl font-bold text-white">Quantum Workflow</h1>
            <nav class="flex items-center gap-6 text-sm font-medium text-slate-400">
                <a id="nav-svm" class="nav-link">Quantum SVM Experiment</a>
                <a id="nav-visualizer" class="nav-link active">Workflow Visualizer</a>
                <a id="nav-qcbm" class="nav-link">Submit QCBM</a>
                <a id="nav-submitter" class="nav-link">Submit QASM</a>
                <a id="nav-ml" class="nav-link">Run ML SVM</a>
            </nav>
        </div>
        <div id="polling-status" class="text-sm text-slate-400 items-center gap-2 hidden">
            <svg class="animate-spin h-4 w-4 text-indigo-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
            <span class="hidden md:inline">Polling for updates...</span>
        </div>
    </header>

    <!-- Main Content -->
    <main id="svm-page" class="flex-1 overflow-y-auto p-8 hidden">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-2xl font-bold text-white mb-2">Run a New Quantum SVM Experiment</h2>
            <p class="text-slate-400 mb-6">Specify the parameters for the QuantumSVMWorkflow and click "Run Experiment" to submit.</p>

            <!-- Main Form -->
            <div class="space-y-8">
                <!-- Dataset Section -->
                <div class="p-6 bg-slate-800 rounded-lg border border-slate-700">
                    <h3 class="text-lg font-semibold text-indigo-400 mb-4">Dataset Configuration</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="ds-generator" class="block text-sm font-medium text-slate-300 mb-1">Generator</label>
                            <input type="text" id="ds-generator" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="make_moons">
                        </div>
                        <div>
                            <label for="ds-samples" class="block text-sm font-medium text-slate-300 mb-1">Samples</label>
                            <input type="number" id="ds-samples" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="100">
                        </div>
                        <div>
                            <label for="ds-noise" class="block text-sm font-medium text-slate-300 mb-1">Noise</label>
                            <input type="number" id="ds-noise" step="0.05" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="0.1">
                        </div>
                        <div>
                            <label for="ds-test-size" class="block text-sm font-medium text-slate-300 mb-1">Test Size</label>
                            <input type="number" id="ds-test-size" step="0.05" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="0.3">
                        </div>
                    </div>
                </div>

                <!-- Kernel & Trainer Section -->
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="p-6 bg-slate-800 rounded-lg border border-slate-700">
                        <h3 class="text-lg font-semibold text-indigo-400 mb-4">Kernel</h3>
                        <div>
                            <label for="kernel-image" class="block text-sm font-medium text-slate-300 mb-1">Container Image</label>
                            <input type="text" id="kernel-image" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="upcloud/quantum-svm:latest">
                        </div>
                    </div>
                    <div class="p-6 bg-slate-800 rounded-lg border border-slate-700">
                        <h3 class="text-lg font-semibold text-indigo-400 mb-4">Trainer</h3>
                        <div>
                            <label for="trainer-c" class="block text-sm font-medium text-slate-300 mb-1">C (Regularization Parameter)</label>
                            <input type="number" id="trainer-c" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="1.0">
                        </div>
                    </div>
                </div>

                <!-- Output Section -->
                <div class="p-6 bg-slate-800 rounded-lg border border-slate-700">
                    <h3 class="text-lg font-semibold text-indigo-400 mb-4">Output</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="output-model-name" class="block text-sm font-medium text-slate-300 mb-1">Model Name</label>
                            <input type="text" id="output-model-name" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="qsvm-model">
                        </div>
                        <div>
                            <label for="output-plot-name" class="block text-sm font-medium text-slate-300 mb-1">Plot Name</label>
                            <input type="text" id="output-plot-name" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="qsvm-decision-boundary">
                        </div>
                    </div>
                </div>

                <!-- Submission & Status Section -->
                <div class="pt-4 flex justify-end items-center gap-6">
                    <div id="svm-status-display" class="text-slate-400 flex items-center gap-3 hidden">
                        <svg id="svm-loading-indicator" class="animate-spin h-5 w-5 text-indigo-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                        <span id="svm-status-text" class="font-medium"></span>
                    </div>
                    <button id="run-experiment-button" class="btn btn-primary">Run Experiment</button>
                </div>
            </div>

            <!-- Results Area -->
            <div id="results-area" class="mt-12 hidden">
                <h2 class="text-2xl font-bold text-white mb-6">Results</h2>
                <div class="space-y-8">
                    <!-- Plot -->
                    <div>
                        <h3 class="text-lg font-semibold text-indigo-400 mb-4">Decision Boundary Plot</h3>
                        <div class="p-4 bg-slate-800 rounded-lg border border-slate-700 min-h-[300px] flex items-center justify-center">
                            <img id="result-plot" src="" alt="Decision Boundary Plot" class="max-w-full h-auto rounded">
                        </div>
                    </div>
                    <!-- Metrics -->
                    <div>
                        <h3 class="text-lg font-semibold text-indigo-400 mb-4">Performance Metrics</h3>
                        <div class="p-4 bg-slate-950 rounded-lg border border-slate-700">
                            <pre id="result-metrics" class="font-code text-sm text-slate-300"></pre>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Error Display -->
            <div id="svm-error-display" class="hidden mt-6 p-4 rounded-md bg-red-500/20 text-red-300 border border-red-500/30">
                <h4 class="font-bold mb-2">An Error Occurred</h4>
                <p id="svm-error-text" class="font-code text-sm"></p>
            </div>
        </div>
    </main>

    <main id="visualizer-page" class="flex-1 flex overflow-hidden">
        <div id="cy-container" class="flex-1 relative">
            <div id="cy"></div>
            <!-- Initial Fetch Overlay -->
            <div id="graph-overlay" class="absolute inset-0 bg-slate-900/80 flex items-center justify-center z-30 transition-opacity duration-300">
                <div class="w-full max-w-md p-4 text-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-12 w-12 text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1"><path stroke-linecap="round" stroke-linejoin="round" d="M10 21h7a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v11m0 5l-2.293-2.293a1 1 0 010-1.414l7-7a1 1 0 011.414 0l7 7a1 1 0 010 1.414L15 21m-5-5h2m-1-4V5" /></svg>
                    <h2 class="mt-2 text-2xl font-bold text-white mb-2">Fetch a Workflow</h2>
                    <p class="text-slate-400 mb-6">Enter the name and namespace of a workflow to visualize its graph.</p>
                    <div class="flex flex-col sm:flex-row gap-3 mb-4">
                        <input type="text" id="workflow-input" class="bg-slate-800 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" placeholder="Workflow Name" value="my-quantum-workflow">
                        <input type="text" id="namespace-input" class="bg-slate-800 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" placeholder="Namespace" value="default">
                    </div>
                    <button id="fetch-button" class="btn btn-primary w-full">Fetch & Visualize</button>
                </div>
            </div>
        </div>
        <!-- Details Panel -->
        <aside id="details-panel" class="w-full md:w-1/3 lg:w-1/4 bg-slate-800/80 backdrop-blur-sm border-l border-slate-700/80 flex flex-col transition-all">
            <div class="p-6 overflow-y-auto flex-1">
                <div id="details-content" class="transition-opacity duration-300 opacity-100">
                    <h2 id="details-title" class="text-xl font-bold text-white mb-6">Status: <span id="workflow-name-display" class="text-indigo-400 font-semibold">Idle</span></h2>
                    <!-- Placeholder shown when no task is selected -->
                    <div id="details-placeholder" class="text-center text-slate-400 pt-10">
                        <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-10 w-10 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z" /></svg>
                        <p class="mt-2">Select a task node from the graph to view its details here.</p>
                        <p id="details-fetch-prompt" class="mt-4 text-sm text-slate-500 hidden">Fetch a workflow to begin.</p>
                    </div>
                    <!-- Data shown when a task is selected -->
                    <div id="details-data" class="hidden space-y-5">
                        <!-- Status Card -->
                        <div class="bg-slate-900/50 p-4 rounded-lg border border-slate-700">
                            <h3 class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                Status
                            </h3>
                            <p id="details-status" class="font-code text-sm font-semibold"></p>
                        </div>

                        <!-- Generic Quantum/Classical Details -->
                        <div id="quantum-classical-details" class="space-y-5">
                            <div class="bg-slate-900/50 p-4 rounded-lg border border-slate-700">
                                <h3 id="details-circuit-title" class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M12 6V3m0 18v-3" /></svg>
                                    Circuit (OpenQASM)
                                </h3>
                                <pre class="bg-slate-950 rounded-md p-3 text-sm font-code text-indigo-300 overflow-x-auto"><code id="details-circuit"></code></pre>
                            </div>
                            <div class="bg-slate-900/50 p-4 rounded-lg border border-slate-700">
                                <h3 class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                                    Parameters
                                </h3>
                                <pre class="bg-slate-950 rounded-md p-3 text-sm font-code text-amber-300 overflow-x-auto"><code id="details-params"></code></pre>
                            </div>
                        </div>

                        <!-- QCBM-Specific Details -->
                        <div id="qcbm-details" class="hidden space-y-5">
                            <div class="bg-slate-900/50 p-4 rounded-lg border border-slate-700">
                                <h3 class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Image</h3>
                                <p id="details-qcbm-image" class="font-code text-sm text-indigo-300"></p>
                            </div>
                            <div class="bg-slate-900/50 p-4 rounded-lg border border-slate-700">
                                <h3 class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Ansatz</h3>
                                <p id="details-qcbm-ansatz" class="font-code text-sm text-indigo-300"></p>
                            </div>
                            <div class="bg-slate-900/50 p-4 rounded-lg border border-slate-700">
                                <h3 class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Optimizer &amp; Training Data</h3>
                                <pre class="bg-slate-950 rounded-md p-3 text-sm font-code text-amber-300 overflow-x-auto"><code id="details-qcbm-params"></code></pre>
                            </div>
                        </div>

                        <div id="results-button-container" class="pt-2"></div>
                    </div>
                </div>
            </div>
        </aside>
    </main>

    <main id="qcbm-submitter-page" class="flex-1 overflow-y-auto p-8 hidden">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-2xl font-bold text-white mb-2">Submit QCBM Workflow</h2>
            <p class="text-slate-400 mb-6">Define a QCBM task and its parameters to create a new workflow.</p>

            <div id="qcbm-notification" class="hidden p-4 mb-4 rounded-md"></div>

            <div class="space-y-6">
                <!-- Workflow Info -->
                <div class="p-6 bg-slate-800 rounded-lg border border-slate-700">
                    <h3 class="text-lg font-semibold text-indigo-400 mb-4">Workflow Details</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="qcbm-workflow-name" class="block text-sm font-medium text-slate-300 mb-1">Workflow Name</label>
                            <input type="text" id="qcbm-workflow-name" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" placeholder="e.g., my-qcbm-training">
                        </div>
                        <div>
                            <label for="qcbm-namespace" class="block text-sm font-medium text-slate-300 mb-1">Namespace</label>
                            <input type="text" id="qcbm-namespace" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="default">
                        </div>
                    </div>
                </div>
                <!-- Task Spec -->
                <div class="p-6 bg-slate-800 rounded-lg border border-slate-700">
                    <h3 class="text-lg font-semibold text-indigo-400 mb-4">Task Specification</h3>
                    <div class="space-y-4">
                        <div>
                            <label for="qcbm-task-name" class="block text-sm font-medium text-slate-300 mb-1">Task Name</label>
                            <input type="text" id="qcbm-task-name" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="qcbm-training-task">
                        </div>
                        <div>
                            <label for="qcbm-image" class="block text-sm font-medium text-slate-300 mb-1">Container Image</label>
                            <input type="text" id="qcbm-image" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="qcbm-runner:latest">
                        </div>
                        <div>
                            <label for="qcbm-ansatz" class="block text-sm font-medium text-slate-300 mb-1">Ansatz</label>
                            <input type="text" id="qcbm-ansatz" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="MyAnsatz">
                        </div>
                        <div>
                            <label for="qcbm-training-data" class="block text-sm font-medium text-slate-300 mb-1">Training Data (one entry per line)</label>
                            <textarea id="qcbm-training-data" rows="4" class="w-full bg-slate-950 border border-slate-600 rounded-md p-3 font-code text-indigo-300 focus:ring-indigo-500 focus:border-indigo-500" placeholder="/path/to/data1.csv&#10;/path/to/data2.csv"></textarea>
                        </div>
                    </div>
                </div>
                <!-- Optimizer -->
                <div class="p-6 bg-slate-800 rounded-lg border border-slate-700">
                    <h3 class="text-lg font-semibold text-indigo-400 mb-4">Optimizer</h3>
                    <div class="space-y-4">
                        <div>
                            <label for="qcbm-opt-name" class="block text-sm font-medium text-slate-300 mb-1">Name</label>
                            <input type="text" id="qcbm-opt-name" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="Adam">
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="qcbm-opt-epochs" class="block text-sm font-medium text-slate-300 mb-1">Epochs</label>
                                <input type="number" id="qcbm-opt-epochs" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="100">
                            </div>
                            <div>
                                <label for="qcbm-opt-lr" class="block text-sm font-medium text-slate-300 mb-1">Learning Rate</label>
                                <input type="number" step="0.001" id="qcbm-opt-lr" class="bg-slate-900 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="0.01">
                            </div>
                        </div>
                        <div>
                            <label for="qcbm-opt-params" class="block text-sm font-medium text-slate-300 mb-1">Initial Parameters (optional JSON string)</label>
                            <textarea id="qcbm-opt-params" rows="3" class="w-full bg-slate-950 border border-slate-600 rounded-md p-3 font-code text-indigo-300 focus:ring-indigo-500 focus:border-indigo-500" placeholder="[0.1, 0.2, 0.3, 0.4]"></textarea>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end">
                    <button id="qcbm-submit-button" class="btn btn-primary">Submit Workflow</button>
                </div>
            </div>
        </div>
    </main>

    <main id="qasm-submitter-page" class="flex-1 overflow-y-auto p-8 hidden">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-2xl font-bold text-white mb-2">Submit OpenQASM Workflow</h2>
            <p class="text-slate-400 mb-6">Paste your OpenQASM 2.0 code below to create and run a new workflow.</p>

            <div id="qasm-notification" class="hidden p-4 mb-4 rounded-md"></div>

            <div class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="qasm-workflow-name" class="block text-sm font-medium text-slate-300 mb-1">Workflow Name</label>
                        <input type="text" id="qasm-workflow-name" class="bg-slate-800 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" placeholder="e.g., my-bell-state-exp">
                    </div>
                    <div>
                        <label for="qasm-namespace" class="block text-sm font-medium text-slate-300 mb-1">Namespace</label>
                        <input type="text" id="qasm-namespace" class="bg-slate-800 border border-slate-600 focus:ring-indigo-500 focus:border-indigo-500 rounded-md py-2 px-3 text-white w-full" value="default">
                    </div>
                </div>
                <div>
                    <label for="qasm-input" class="block text-sm font-medium text-slate-300 mb-1">OpenQASM 2.0 Code</label>
                    <textarea id="qasm-input" rows="15" class="w-full bg-slate-950 border border-slate-600 rounded-md p-3 font-code text-indigo-300 focus:ring-indigo-500 focus:border-indigo-500" placeholder="OPENQASM 2.0;&#ninclude &quot;qelib1.inc&quot;;&#n&#10;qreg q[2];&#10;creg c[2];&#10;&#10;h q[0];&#10;cx q[0], q[1];&#10;measure q -> c;"></textarea>
                </div>
                <div class="flex justify-end">
                    <button id="qasm-submit-button" class="btn btn-primary">Submit Workflow</button>
                </div>
            </div>
        </div>
    </main>

    <main id="ml-page" class="flex-1 overflow-y-auto p-8 hidden">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-2xl font-bold text-white mb-2">Run Classical/Quantum SVM</h2>
            <p class="text-slate-400 mb-6">Upload a CSV or use dummy data, set parameters, and run the workflow.</p>
            <div class="space-y-4">
                <div>
                    <label for="ml-data-file" class="block text-sm font-medium text-slate-300 mb-1">CSV Data File</label>
                    <input type="file" id="ml-data-file" class="bg-slate-800 border border-slate-600 rounded-md py-2 px-3 text-white w-full">
                </div>
                <div>
                    <label for="ml-target-column" class="block text-sm font-medium text-slate-300 mb-1">Target Column</label>
                    <input type="text" id="ml-target-column" class="bg-slate-800 border border-slate-600 rounded-md py-2 px-3 text-white w-full" value="target">
                </div>
                <div>
                    <label for="ml-test-size" class="block text-sm font-medium text-slate-300 mb-1">Test Size</label>
                    <input type="number" id="ml-test-size" class="bg-slate-800 border border-slate-600 rounded-md py-2 px-3 text-white w-full" value="0.3" step="0.01" min="0.05" max="0.95">
                </div>
                <div class="flex justify-end">
                    <button id="ml-run-button" class="btn btn-primary">Run SVM</button>
                </div>
            </div>
            <div id="ml-results-area" class="mt-8 hidden">
                <h3 class="text-lg font-semibold text-indigo-400 mb-4">Results</h3>
                <div id="ml-metrics" class="bg-slate-950 rounded-md p-3 text-sm font-code text-slate-300"></div>
                <img id="ml-plot" src="" alt="SVM Decision Boundary" class="max-w-full h-auto rounded mt-4">
            </div>
            <div id="ml-error-display" class="hidden mt-6 p-4 rounded-md bg-red-500/20 text-red-300 border border-red-500/30"></div>
        </div>
    </main>
</div>

<!-- Modals -->
<div id="error-modal-overlay" class="modal-overlay">
    <div id="error-modal-content" class="modal-content" onclick="event.stopPropagation()"></div>
</div>

<div id="results-modal-overlay" class="modal-overlay">
    <div id="results-modal-content" class="modal-content" onclick="event.stopPropagation()">
        <button class="modal-close-btn" onclick="closeModal('results-modal-overlay')">&times;</button>
        <h2 id="results-modal-title" class="text-indigo-400 shrink-0">Task Results</h2>
        <!-- Tabs -->
        <div class="border-b border-slate-600 mb-4 shrink-0">
            <nav id="results-tabs" class="-mb-px flex space-x-6" aria-label="Tabs">
                <a href="#" id="tab-vis" class="whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-indigo-500 text-indigo-400">State Vector</a>
                <a href="#" id="tab-log" class="whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-slate-400 hover:text-slate-300 hover:border-slate-400">Raw Log</a>
            </nav>
        </div>
        <div class="flex-1 overflow-y-auto">
            <div id="q-state-vis-container" class="">
                <h3 class="text-sm font-semibold text-slate-400 mb-2">State Vector Probabilities</h3>
                <div id="q-state-vis" class="w-full h-72"></div>
            </div>
            <div id="raw-log-container" class="hidden">
                <pre><code id="results-modal-log" class="font-code text-sm"></code></pre>
            </div>
        </div>
    </div>
</div>

<script src="qflow.js"></script>
</body>
</html>
